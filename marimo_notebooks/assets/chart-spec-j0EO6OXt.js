import{D as e,N as n,a as l,l as i,b as r,C as o}from"./index-CP44XdE5.js";function a(l,i,r,a,c,m){var y,p,C,h,x,b,k,w,A,B,E,I;let P=null==(y=r.general.xColumn)?void 0:y.field,z=null==(p=r.general.yColumn)?void 0:p.field;(null==(C=r.general.yColumn)?void 0:C.agg)&&r.general.yColumn.agg!==e&&(z=`${r.general.yColumn.agg.toUpperCase()}(${z})`),(null==(h=r.xAxis)?void 0:h.label)&&""!==r.xAxis.label.trim()&&(P=r.xAxis.label),(null==(x=r.yAxis)?void 0:x.label)&&""!==r.yAxis.label.trim()&&(z=r.yAxis.label);const $=l===o.PIE?"theta":"x",j=l===o.PIE?"color":"y",T=(null==(b=r.general.groupByColumn)?void 0:b.field)!==n,q=T&&r.general.horizontal,D=T&&!r.general.horizontal,N={field:null==(k=r.general.xColumn)?void 0:k.field,type:f((null==(w=r.general.xColumn)?void 0:w.type)??"unknown"),bin:d(null==(A=r.xAxis)?void 0:A.bin),title:P,stack:q?r.general.stacking:void 0},O=u(r),R={field:null==(B=r.general.yColumn)?void 0:B.field,type:f((null==(E=r.general.yColumn)?void 0:E.type)??"unknown"),bin:d(null==(I=r.yAxis)?void 0:I.bin),title:z,scale:O&&"color"===j?{...O}:void 0,stack:D?r.general.stacking:void 0};return{$schema:"https://vega.github.io/schema/vega-lite/v5.json",background:"dark"===a?"dark":"white",title:r.general.title,data:{values:i},height:m,width:c,mark:{type:v(l)},encoding:{[$]:r.general.horizontal?R:N,[j]:r.general.horizontal?N:R,xOffset:g(l,r),...t(l,r),tooltip:s(r)}}}function t(e,l){var i,r,a;if(e===o.PIE||(null==(i=l.general.groupByColumn)?void 0:i.field)===n)return;return{color:{field:null==(r=l.general.groupByColumn)?void 0:r.field,type:f((null==(a=l.general.groupByColumn)?void 0:a.type)??"unknown"),scale:{...u(l)}}}}function u(e){var n,l;const i=null==(n=e.color)?void 0:n.range;if(i&&i.length>0)return{range:i};const o=null==(l=e.color)?void 0:l.scheme;return o!==r?{scheme:o}:void 0}function g(e,l){var i,r,a;if(!l.general.stacking&&(null==(i=l.general.groupByColumn)?void 0:i.field)!==n&&e!==o.PIE)return{field:(null==(r=l.general.groupByColumn)?void 0:r.field)===n||null==(a=l.general.groupByColumn)?void 0:a.field}}function d(e){if(null==e?void 0:e.binned)return e.step===l||{binned:!0,step:e.step}}function s(n){var l;return null==(l=n.general.tooltips)?void 0:l.map((l=>({field:l.field,aggregate:(()=>{var i,r,o;if(l.field===(null==(i=n.general.yColumn)?void 0:i.field))return(null==(r=n.general.yColumn)?void 0:r.agg)===e||null==(o=n.general.yColumn)?void 0:o.agg})(),format:c(l.type)})))}function c(e){switch(e){case"integer":return",d";case"number":return".2f";default:return}}function f(e){switch(e){case"number":case"integer":return"quantitative";case"string":case"boolean":case"unknown":return"nominal";case"date":case"datetime":case"time":return"temporal";default:return i(e),"nominal"}}function v(e){switch(e){case o.PIE:return"arc";case o.SCATTER:return"point";default:return e}}export{a as createVegaSpec};
